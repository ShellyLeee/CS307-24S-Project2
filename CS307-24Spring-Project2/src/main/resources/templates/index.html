<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>地铁管理系统</title>
    <style>
        body {
            text-align: center; /* 让标题居中 */
        }
        .buttons {
            margin-top: 20px; /* 距离标题的上边距 */
        }
        .buttons button {
            margin: 5px; /* 按钮之间的间距 */
        }
    </style>

    <style>
        /* 样式用于模态框 */
        .modal {
            display: none; /* 初始隐藏 */
            position: fixed;
            z-index: 1;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.4); /* 半透明背景 */
        }
        .modal-content {
            background-color: #fefefe;
            margin: 15% auto;
            padding: 20px;
            border: 1px solid #888;
            width: 80%;
        }
        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
        }
        .close:hover,
        .close:focus {
            color: black;
            text-decoration: none;
            cursor: pointer;
        }
    </style>
</head>
<body>
<h1>地铁管理系统</h1>

<div class="buttons">
    <!-- 按钮触发对话框 -->
    <button onclick="openInsertDialog()">增加站点</button>
    <button onclick="openDeleteDialog()">删除站点</button>
    <button onclick="openSelectDialog()">查询站点</button>
    <button onclick="openUpdateDialog()">修改站点</button>
    <br><br>
    <button onclick="openLineInsertDialog()">增加线路</button>
    <button onclick="openLineDeleteDialog()">删除线路</button>
    <button onclick="openLineSelectDialog()">查询线路</button>
    <button onclick="openLineUpdateDialog()">修改线路</button>
    <br><br>
    <button onclick="openSpecificInsertDialog()">地铁线指定位置增加站点</button>
    <button onclick="openSpecificDeleteDialog()">地铁线指定位置删除站点</button>
    <br><br>
    <button id="boardExitButton">出站/进站</button>
    <button id="viewPassengerButton">查询进站乘客</button>
    <button id="viewCardButton">查询进站公交卡</button>
    <br><br>
    <button onclick="openMultiCardRideDialog()">多参数查询Card乘车记录</button>
    <button onclick="openMultiPassengerRideDialog()">多参数查询Passenger乘车记录</button>

</div>

<!-- 输入多参数查询CardRide的对话框 -->
<div id="multiCardRideDialog" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeMultiCardRideDialog()">&times;</span>
        <p>请输入想要查询的乘车记录相关参数：</p>
        <input type="text" id="cardCodeInput" placeholder="code">
        <input type="text" id="startStationCInput" placeholder="起始站点">
        <input type="text" id="endStationCInput" placeholder="终止站点">
        <input type="number" id="priceCInput" placeholder="价钱">
        <input type="text" id="startTimeCInput" placeholder="晚于此起始时间">
        <input type="text" id="endTimeCInput" placeholder="早于此终止时间">
        <br><br>
        <button onclick="submitMultiCardRideSelect()">提交</button>
    </div>
</div>
<script>

    function openMultiCardRideDialog() {
        var selectDialog = document.getElementById("multiCardRideDialog");
        selectDialog.style.display = "block";
    }
    function closeMultiCardRideDialog() {
        var selectDialog = document.getElementById("multiCardRideDialog");
        selectDialog.style.display = "none";
    }
    function submitMultiCardRideSelect() {
        var cardCode = document.getElementById("cardCodeInput").value;
        var startStation = document.getElementById("startStationCInput").value;
        var price = document.getElementById("priceCInput").value;
        var endStation = document.getElementById("endStationCInput").value;
        var startTimeInput = document.getElementById("startTimeCInput").value;
        var endTimeInput = document.getElementById("endTimeCInput").value;

        if (startTimeInput && endTimeInput) {
            // 将输入的文本解析为 Date 对象
            var startTime = new Date(startTimeInput);
            var endTime = new Date(endTimeInput);

            // 将 Date 对象转换为 ISO 8601 格式的字符串
            var startTimeISO = startTime.toISOString();
            var endTimeISO = endTime.toISOString();
        }
// 构建URL
        var url = "/cardRide/multiSelect?";
        if (cardCode) url += "cardCode=" + cardCode + "&";
        if (startStation) url += "startStation=" + startStation + "&";
        if (endStation) url += "endStation=" + endStation + "&";
        if (price) url += "price=" + price + "&";
        if (startTimeISO) url += "startTime=" + startTimeISO + "&";
        if (endTimeISO) url += "endTime=" + endTimeISO + "&";

        // 跳转到查询结果页面
        window.location.href = url;

// 发送GET请求
        fetch(url, {
            method: 'GET',
            headers: {
                'Content-Type': 'application/json'
            }
        })
            .then(response => response.json())
            .then(data => {
// 处理从后端返回的数据
                console.log(data);
            })
            .catch(error => {
// 处理错误
                console.error('Error:', error);
            });

// 关闭对话框
        closeMultiCardRideDialog();
    }



</script>


<!-- 输入查询站点ID的对话框 -->
<div id="inputSelectDialog" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeSelectDialog()">&times;</span>
        <p>请输入想要查询的站点ID：</p>
        <input type="number" id="stationIdSelect">
        <br><br>
        <button onclick="submitContentSelect()">提交</button>
    </div>
</div>
<script>
    var modal = document.getElementById("inputSelectDialog");

    function openSelectDialog() {
        var selectDialog = document.getElementById("inputSelectDialog");
        selectDialog.style.display = "block";
    }
    function closeSelectDialog() {
        var selectDialog = document.getElementById("inputSelectDialog");
        selectDialog.style.display = "none";
    }
    function submitContentSelect() {
        var stationId = document.getElementById("stationIdSelect").value;
        if (stationId >= 1 && stationId <= 306) {
            // 构造目标跳转链接
            var targetURL = "http://localhost:8080/station/selectById?id=" + stationId;
            // 执行页面跳转
            window.location.href = targetURL;
        } else {
            alert("请输入1到306之间的数字！");
        }
// 关闭对话框
        closeSelectDialog();
    }

</script>


<!-- 输入查询线路信息的对话框 -->
<div id="inputLineSelectDialog" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeLineSelectDialog()">&times;</span>
        <p>请输入想要查询的线路名称：</p>
        <input type="text" id="lineNameSelectInput">
        <br><br>
        <button onclick="submitLineSelect()">提交</button>
    </div>
</div>
<script>
    function openLineSelectDialog() {
        var selectDialog = document.getElementById("inputLineSelectDialog");
        selectDialog.style.display = "block";
    }
    function closeLineSelectDialog() {
        var selectDialog = document.getElementById("inputLineSelectDialog");
        selectDialog.style.display = "none";
    }
    function submitLineSelect() {
        var lineName = document.getElementById("lineNameSelectInput").value;
        // 构造目标跳转链接
        var targetURL = `http://localhost:8080/line/selectByNameInfo?name=${lineName}`;

        // 执行页面跳转
        window.location.href = targetURL;
// 关闭对话框
        closeLineSelectDialog();
    }

</script>


<!-- 输入增加站点的对话框 -->
<div id="inputInsertDialog" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeInsertDialog()">&times;</span>
        <p>请输入想要增加的站点信息：</p>
        <label for="district">地区:</label>
        <input type="String" id="district">
        <label for="englishName">英文名:</label>
        <input type="String" id="englishName">
        <label for="chineseName">中文名:</label>
        <input type="String" id="chineseName">
        <label for="intro">介绍:</label>
        <input type="String" id="intro">
        <br><br>
        <button onclick="submitInsert()">提交</button>
    </div>
</div>
<script>
    function openInsertDialog() {
        var insertDialog = document.getElementById("inputInsertDialog");
        insertDialog.style.display = "block";
    }
    function closeInsertDialog() {
        var insertDialog = document.getElementById("inputInsertDialog");
        insertDialog.style.display = "none";
    }
    function submitInsert() {
        var district = document.getElementById("district").value;
        var englishName = document.getElementById("englishName").value;
        var chineseName = document.getElementById("chineseName").value;
        var intro = document.getElementById("intro").value;

        var data = {
            district: district,
            englishName: englishName,
            chineseName: chineseName,
            intro: intro
        };

        fetch('http://localhost:8080/station/insert', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(data)
        })
            .then(response => {
                if (response.ok) {
                    return response.text();
                }
                throw new Error('站点添加失败！');
            })
            .then(message => {
                alert("站点添加成功！" + message);
                // 成功后可以选择隐藏对话框和清除输入框的值
                document.getElementById("inputInsertDialog").style.display = "none";
                document.getElementById("district").value = '';
                document.getElementById("englishName").value = '';
                document.getElementById("chineseName").value = '';
                document.getElementById("intro").value = '';
            })
            .catch(error => {
                alert("站点添加失败：" + error.message);
            });
        // 关闭对话框
        closeInsertDialog();
    }
</script>


<!-- 输入增加线路信息的对话框 -->
<div id="inputLineInsertDialog" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeLineInsertDialog()">&times;</span>
        <p>请输入想要增加的线路信息：</p>
        <label for="name">线路名称:</label>
        <input type="String" id="name">
        <label for="startTime">起始时间:</label>
        <input type="String" id="startTime">
        <label for="endTime">终止时间:</label>
        <input type="String" id="endTime">
        <label for="lineIntro">线路介绍:</label>
        <input type="String" id="lineIntro">
        <label for="mileage">英里数:</label>
        <input type="String" id="mileage">
        <label for="color">线路颜色:</label>
        <input type="String" id="color">
        <label for="firstOpening">最初开放时间:</label>
        <input type="String" id="firstOpening">
        <label for="url">URL:</label>
        <input type="String" id="url">
        <br><br>
        <button onclick="submitLineInsert()">提交</button>
    </div>
</div>
<script>
    function openLineInsertDialog() {
        var insertLineDialog = document.getElementById("inputLineInsertDialog");
        insertLineDialog.style.display = "block";
    }
    function closeLineInsertDialog() {
        var insertLineDialog = document.getElementById("inputLineInsertDialog");
        insertLineDialog.style.display = "none";
    }
    function submitLineInsert() {
        var name = document.getElementById("name").value;
        var startTime = document.getElementById("startTime").value;
        var endTime = document.getElementById("endTime").value;
        var lineIntro = document.getElementById("lineIntro").value;
        var mileage = document.getElementById("mileage").value;
        var color = document.getElementById("color").value;
        var firstOpening = document.getElementById("firstOpening").value;
        var url = document.getElementById("url").value;

        var data = {
            name: name,
            startTime: startTime,
            endTime: endTime,
            lineIntro: lineIntro,
            mileage: mileage,
            color: color,
            firstOpening: firstOpening,
            url: url
        };

        fetch('http://localhost:8080/line/insert', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(data)
        })
            .then(response => {
                if (response.ok) {
                    return response.text();
                }
                throw new Error('线路添加失败！');
            })
            .then(message => {
                alert("线路添加成功！" + message);
            })
            .catch(error => {
                alert("线路添加失败：" + error.message);
            });
        // 关闭对话框
        closeLineInsertDialog();
    }
</script>

<!-- 输入增加一个或多个站点到地铁线指定位置的对话框 -->
<div id="specificInsertDialog" class="modal" style="display: none;">
    <div class="modal-content">
        <span class="close" onclick="closeSpecificInsertDialog()">&times;</span>
        <p>请输入想插入的目标线路中文名：</p>
        <label for="lineT">线路:</label>
        <input type="String" id="lineT">
        <p>请输入想插入的目标站点英文名：</p>
        <label for="stationT">站点:</label>
        <input type="String" id="stationT">
        <p>请选择插入先后顺序：</p>
        <label for="insertFirst">先</label>
        <input type="radio" id="insertFirst" name="insertOrder" value="first">
        <label for="insertSecond">后</label>
        <input type="radio" id="insertSecond" name="insertOrder" value="second">
        <p>请输入想插入的站点个数：</p>
        <label for="stationNumber">个数:</label>
        <input type="number" id="stationNumber">
        <br><br>
        <button onclick="confirmSpecificInsertUpdate()">确认</button>
    </div>
</div>
<div id="specificInsertSelectDialog" class="modal" style="display: none;">
    <div class="modal-content">
        <span class="close" onclick="closeSpecificInsertSelectDialog()">&times;</span>
        <form id="insertForm">
            <p>请输入想要插入的站点英文名：</p>
            <div id="stationInputs">
                <!-- 这里将会动态生成对应数量的输入框 -->
            </div>
            <br><br>
            <button type="button" onclick="submitSpecificInsertSelectUpdate()">提交</button>
        </form>
    </div>
</div>
<script>
    function openSpecificInsertDialog() {
        var dialog = document.getElementById("specificInsertDialog");
        dialog.style.display = "block";
    }

    function openSpecificInsertSelectDialog() {
        var dialog = document.getElementById("specificInsertSelectDialog");
        dialog.style.display = "block";
    }

    function closeSpecificInsertDialog() {
        var dialog = document.getElementById("specificInsertDialog");
        dialog.style.display = "none";
    }

    function closeSpecificInsertSelectDialog() {
        var dialog = document.getElementById("specificInsertSelectDialog");
        dialog.style.display = "none";
    }

    function confirmSpecificInsertUpdate() {
        var stationNumber = document.getElementById('stationNumber').value;
        var stationInputs = document.getElementById('stationInputs');
        stationInputs.innerHTML = ''; // 清空之前的输入框

        for (var i = 0; i < stationNumber; i++) {
            var input = document.createElement('input');
            input.type = 'text';
            input.name = 'stationName' + i; // 给每个输入框一个独特的名称
            input.placeholder = '请输入第' + (i+1) + '个站点的英文名';
            stationInputs.appendChild(input);
            stationInputs.appendChild(document.createElement('br')); // 每个输入框后面添加换行
        }

        openSpecificInsertSelectDialog(); // 打开选择站点的弹窗
        closeSpecificInsertDialog();
    }

    function submitSpecificInsertSelectUpdate() {
        var stationValues = []; // Array to store station names
        var stationNumber = document.getElementById('stationNumber').value;

        // Loop through each input field to collect values
        for (var i = 0; i < stationNumber; i++) {
            var stationInput = document.getElementsByName('stationName' + i)[0].value;
            stationValues.push(stationInput);
        }

        // Other parameters like lineName
        var lineName = document.getElementById('lineT').value;
        var stationName = document.getElementById('stationT').value;
        var order = document.querySelector('input[name="insertOrder"]:checked').value;

        // Prepare data object to send to backend
        var data1 = {
            n: stationNumber,
            lineName: lineName,
            stationName: stationName
        };

        var data2 = {
            n: stationNumber,
            lineName: lineName,
            stationName: stationName,
            stations: stationValues // Sending station names as an array
        };

        if (order === "first") {
            fetch('/updateInsertStationNoFront', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(data1),
            })
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Network response was not ok');
                    }
                    // Handle response if needed
                    respondUpdateFront()
                })
                .catch(error => {
                    console.error('There was a problem with your fetch operation:', error);
                });
        }
        else if(order === "second"){
            fetch('/updateInsertStationNoBehind', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(data1),
            })
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Network response was not ok');
                    }
                    // Handle response if needed
                    respondUpdateBehind()
                })
                .catch(error => {
                    console.error('There was a problem with your fetch operation:', error);
                });

        }

        function respondUpdateFront(){
            fetch('/insertMultipleStationsFront', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(data2),
            })
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Network response was not ok');
                    }
                    // Handle response if needed
                })
                .then(message => {
                    alert("站点添加成功！" + message);
                })
                .catch(error => {
                    alert("站点添加失败：" + error.message);
                })
                .catch(error => {
                    console.error('There was a problem with your fetch operation:', error);
                });
        }

        function respondUpdateBehind(){
            fetch('/insertMultipleStationsBehind', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(data2),
            })
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Network response was not ok');
                    }
                    // Handle response if needed
                })
                .then(message => {
                    alert("站点添加成功！" + message);
                })
                .catch(error => {
                    alert("站点添加失败：" + error.message);
                })
                .catch(error => {
                    console.error('There was a problem with your fetch operation:', error);
                });
        }
        closeSpecificInsertSelectDialog();
    }
</script>


<!-- 输入删除站点ID的对话框 -->
<div id="inputDeleteDialog" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeDeleteDialog()">&times;</span>
        <p>请输入想要删除的站点ID：</p>
        <input type="number" id="stationIdDelete">
        <br><br>
        <button onclick="submitDelete()">提交</button>
    </div>
</div>
<script>
    function openDeleteDialog() {
        var deleteDialog = document.getElementById("inputDeleteDialog");
        deleteDialog.style.display = "block";
    }
    function closeDeleteDialog() {
        var deleteDialog = document.getElementById("inputDeleteDialog");
        deleteDialog.style.display = "none";
    }
    function submitDelete() {
        var stationId = document.getElementById("stationIdDelete").value;
        if (stationId >= 1 && stationId <= 400) {
            fetch('http://localhost:8080/station/delete?id=' + stationId, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
            })
                .then(response => {
                    if (response.ok) {
                        return response.text();
                    }
                    throw new Error('站点删除失败！');
                })
                .then(message => {
                    alert("站点删除成功！" + message);
                    // 成功后可以选择隐藏对话框和清除输入框的值
                    document.getElementById("inputDeleteDialog").style.display = "none";
                    document.getElementById("stationIdDelete").value = '';
                })
                .catch(error => {
                    alert("站点删除失败：" + error.message);
                });
        } else {
            alert("请输入1到400之间的数字！");
        }
// 关闭对话框
        closeDeleteDialog();
    }
</script>


<!-- 输入删除线路信息的对话框 -->
<div id="inputLineDeleteDialog" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeLineDeleteDialog()">&times;</span>
        <p>请输入想要删除的线路名称：</p>
        <input type="text" id="lineNameDelete">
        <br><br>
        <button onclick="submitLineDelete()">提交</button>
    </div>
</div>
<script>
    function openLineDeleteDialog() {
        var deleteLineDialog = document.getElementById("inputLineDeleteDialog");
        deleteLineDialog.style.display = "block";
    }
    function closeLineDeleteDialog() {
        var deleteLineDialog = document.getElementById("inputLineDeleteDialog");
        deleteLineDialog.style.display = "none";
    }
    function submitLineDelete() {
        var lineName = document.getElementById("lineNameDelete").value;
        fetch(`http://localhost:8080/line/delete?name=${lineName}`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
        })
            .then(response => {
                if (response.ok) {
                    return response.text();
                }
                throw new Error('线路删除失败！');
            })
            .then(message => {
                alert("线路删除成功！" + message);
            })
            .catch(error => {
                alert("线路删除失败：" + error.message);
            });
// 关闭对话框
        closeLineDeleteDialog();
    }
</script>


<!-- 修改站点信息的对话框：有2个框的设计 -->
<div id="updateDialog" class="modal" style="display: none;">
    <div class="modal-content">
        <span class="close" onclick="closeUpdateDialog()">&times;</span>
        <p>请输入想修改的站点中文名：</p>
        <input type="text" id="chineseNameInput">
        <br><br>
        <button onclick="confirmUpdate()">确认</button>
    </div>
</div>
<div id="stationInfoDialog" class="modal" style="display: none;">
    <div class="modal-content">
        <span class="close" onclick="closeStationInfoDialog()">&times;</span>
        <p id="stationInfo"></p>
        <!-- 这里添加四个框，用来输入需要修改的内容 -->
        <input type="text" id="districtInput" placeholder="地区">
        <input type="text" id="englishNameInput" placeholder="英文名">
        <input type="text" id="chineseNameInput1" placeholder="中文名">
        <input type="text" id="introInput" placeholder="简介">
        <br><br>
        <button onclick="submitUpdate()">提交</button>
    </div>
</div>
<script>
    function openUpdateDialog() {
        var dialog = document.getElementById("updateDialog");
        dialog.style.display = "block";
    }

    function closeUpdateDialog() {
        var dialog = document.getElementById("updateDialog");
        dialog.style.display = "none";
    }

    function closeStationInfoDialog() {
        var dialog = document.getElementById("stationInfoDialog");
        dialog.style.display = "none";
    }

    function confirmUpdate() {
        var chineseName = document.getElementById("chineseNameInput").value;
        // 调用后端接口获取站点信息
        fetch(`http://localhost:8080/station/selectByChineseName?chineseName=${chineseName}`)
            .then(response => response.json())
            .then(data => {
                // 显示站点信息的对话框
                var dialog = document.getElementById("stationInfoDialog");
                dialog.style.display = "block";
                // 更新站点信息对话框中的内容
                document.getElementById("districtInput").value = data.district;
                document.getElementById("englishNameInput").value = data.englishName;
                document.getElementById("chineseNameInput1").value = data.chineseName;
                document.getElementById("introInput").value = data.intro;
            })
            .catch(error => console.error('Error:', error));
        closeUpdateDialog();
    }

    function submitUpdate() {
        var district = document.getElementById("districtInput").value;
        var englishName = document.getElementById("englishNameInput").value;
        var chineseName = document.getElementById("chineseNameInput1").value;
        var intro = document.getElementById("introInput").value;
        var data = {
            district: district,
            englishName: englishName,
            chineseName: chineseName,
            intro: intro
        };
        fetch('http://localhost:8080/station/updateStation', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(data)
        })
            .then(response => {
                if (response.ok) {
                    return response.text();
                }
                throw new Error('站点修改失败！');
            })
            .then(message => {
                alert("站点修改成功！" + message);
            })
            .catch(error => {
                alert("站点修改失败：" + error.message);
            });
        closeStationInfoDialog();
    }
</script>


<!-- 修改线路信息的对话框：有2个框的设计 -->
<div id="updateLineDialog" class="modal" style="display: none;">
    <div class="modal-content">
        <span class="close" onclick="closeLineUpdateDialog()">&times;</span>
        <p>请输入想修改的线路中文名：</p>
        <input type="text" id="chineseLineNameInput">
        <br><br>
        <button onclick="confirmLineUpdate()">确认</button>
    </div>
</div>
<div id="lineInfoDialog" class="modal" style="display: none;">
    <div class="modal-content">
        <span class="close" onclick="closeLineInfoDialog()">&times;</span>
        <p id="lineInfo"></p>
        <!-- 这里添加四个框，用来输入需要修改的内容 -->
        <label for="nameInput">线路名称:</label>
        <input type="text" id="nameInput" placeholder="线路名称">
        <label for="startTimeInput">起始时间:</label>
        <input type="text" id="startTimeInput" placeholder="起始时间">
        <label for="endTimeInput">终止时间:</label>
        <input type="text" id="endTimeInput" placeholder="终止时间">
        <label for="introInput1">简介:</label>
        <input type="text" id="introInput1" placeholder="简介">
        <label for="mileageInput">英里数:</label>
        <input type="text" id="mileageInput" placeholder="英里数">
        <label for="colorInput">线路颜色:</label>
        <input type="text" id="colorInput" placeholder="线路颜色">
        <label for="firstOpeningInput">首开日期:</label>
        <input type="text" id="firstOpeningInput" placeholder="首开日期">
        <label for="urlInput">url:</label>
        <input type="text" id="urlInput" placeholder="url">
        <br><br>
        <button onclick="submitLineUpdate()">提交</button>
    </div>
</div>
<script>
    function openLineUpdateDialog() {
        var dialog = document.getElementById("updateLineDialog");
        dialog.style.display = "block";
    }

    function closeLineUpdateDialog() {
        var dialog = document.getElementById("updateLineDialog");
        dialog.style.display = "none";
    }

    function closeLineInfoDialog() {
        var dialog = document.getElementById("lineInfoDialog");
        dialog.style.display = "none";
    }

    function confirmLineUpdate() {
        var chineseName = document.getElementById("chineseLineNameInput").value;
        // 调用后端接口获取站点信息
        fetch(`http://localhost:8080/line/selectByName?name=${chineseName}`)
            .then(response => response.json())
            .then(data => {
                // 显示站点信息的对话框
                var dialog = document.getElementById("lineInfoDialog");
                dialog.style.display = "block";
                // 更新站点信息对话框中的内容
                document.getElementById("nameInput").value = data.name;
                document.getElementById("startTimeInput").value = data.startTime;
                document.getElementById("endTimeInput").value = data.endTime;
                document.getElementById("introInput1").value = data.intro;
                document.getElementById("mileageInput").value = data.mileage;
                document.getElementById("colorInput").value = data.color;
                document.getElementById("firstOpeningInput").value = data.firstOpening;
                document.getElementById("urlInput").value = data.url;
            })
            .catch(error => console.error('Error:', error));
        closeLineUpdateDialog();
    }

    function submitLineUpdate() {
        var name = document.getElementById("nameInput").value;
        var startTime = document.getElementById("startTimeInput").value;
        var endTime = document.getElementById("endTimeInput").value;
        var intro = document.getElementById("introInput1").value;
        var mileage = document.getElementById("mileageInput").value;
        var color = document.getElementById("colorInput").value;
        var firstOpening = document.getElementById("firstOpeningInput").value;
        var url = document.getElementById("urlInput").value;
        var data = {
            name: name,
            startTime: startTime,
            endTime: endTime,
            intro: intro,
            mileage: mileage,
            color: color,
            firstOpening: firstOpening,
            url: url
        };
        fetch('http://localhost:8080/line/updateLine', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(data)
        })
            .then(response => {
                if (response.ok) {
                    return response.text();
                }
                throw new Error('线路修改失败！');
            })
            .then(message => {
                alert("线路修改成功！" + message);
            })
            .catch(error => {
                alert("线路修改失败：" + error.message);
            });
        closeLineInfoDialog();
    }
</script>




<!-- 输入上车/下车乘客信息的对话框-->
<div id="inputPassengerDialog" style="display: none;">
    <p>请输入乘客信息（ID与卡号选填一个）：</p>
    <label for="PassengerID">ID:</label>
    <input type="String" id="PassengerID">
    <label for="CardCode">卡号:</label>
    <input type="String" id="CardCode">
    <label for="start_station">始发站:</label>
    <input type="String" id="start_station">
    <label for="exit_station">终到站:</label>
    <input type="String" id="exit_station">
    <br><br>
    <button id="boardConfirmButton1">普通车厢进站</button>
    <button id="boardConfirmButton2">商务车厢进站</button>
    <button id="exitConfirmButton">出站</button>
</div>

<!-- 乘客上下车按钮逻辑 -->
<script>
    document.getElementById("boardExitButton").addEventListener("click", function() {
// 弹出输入框
        var dialog = document.getElementById("inputPassengerDialog");
        if (dialog.style.display === "none" || dialog.style.display === "") {
            dialog.style.display = "block";
        } else {
            dialog.style.display = "none";
        }
    });

    document.getElementById("boardConfirmButton1").addEventListener("click", function () {
        var ID = document.getElementById("PassengerID").value;
        var code = document.getElementById("CardCode").value;
        var startStation = document.getElementById("start_station").value;
        var time = new Date(new Date().getTime()).toISOString();
        if (ID != '') {
            var data = {
                passengerId: ID,
                startStation: startStation,
                startTime: time,
                type: '普通',
            };
            fetch('http://localhost:8080/passengerOnboard/insert', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(data)
            })
                .then(response => {
                    if (response.ok) {
                        return response.text();
                    }
                    throw new Error('乘客进站失败！');
                })
                .then(message => {
                    alert("乘客进站成功！" + message);
                    // 成功后可以选择隐藏对话框和清除输入框的值
                    document.getElementById("inputPassengerDialog").style.display = "none";
                    document.getElementById("PassengerID").value = '';
                    document.getElementById("start_station").value = '';
                })
                .catch(error => {
                    alert("乘客进站失败：" + error.message);
                });
        } else if (code != ''){
            var data = {
                cardCode: code,
                startStation: startStation,
                startTime: time,
                type: '普通',
            };
            fetch('http://localhost:8080/cardOnboard/insert', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(data)
            })
                .then(response => {
                    if (response.ok) {
                        return response.text();
                    }
                    throw new Error('乘客进站失败！');
                })
                .then(message => {
                    alert("乘客进站成功！" + message);
                    // 成功后可以选择隐藏对话框和清除输入框的值
                    document.getElementById("inputPassengerDialog").style.display = "none";
                    document.getElementById("CardCode").value = '';
                    document.getElementById("start_station").value = '';
                })
                .catch(error => {
                    alert("乘客进站失败：" + error.message);
                });
        }
    })

    document.getElementById("boardConfirmButton2").addEventListener("click", function () {
        var ID = document.getElementById("PassengerID").value;
        var code = document.getElementById("CardCode").value;
        var startStation = document.getElementById("start_station").value;
        var time = new Date(new Date().getTime()).toISOString();
        if (ID != '') {
            var data = {
                passengerId: ID,
                startStation: startStation,
                startTime: time,
                type: '商务',
            };
            fetch('http://localhost:8080/passengerOnboard/insert', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(data)
            })
                .then(response => {
                    if (response.ok) {
                        return response.text();
                    }
                    throw new Error('乘客进站失败！');
                })
                .then(message => {
                    alert("乘客进站成功！" + message);
                    // 成功后可以选择隐藏对话框和清除输入框的值
                    document.getElementById("inputPassengerDialog").style.display = "none";
                    document.getElementById("PassengerID").value = '';
                    document.getElementById("start_station").value = '';
                })
                .catch(error => {
                    alert("乘客进站失败：" + error.message);
                });
        } else if (code != ''){
            var data = {
                cardCode: code,
                startStation: startStation,
                startTime: time,
                type: '商务',
            };
            fetch('http://localhost:8080/cardOnboard/insert', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(data)
            })
                .then(response => {
                    if (response.ok) {
                        return response.text();
                    }
                    throw new Error('乘客进站失败！');
                })
                .then(message => {
                    alert("乘客进站成功！" + message);
                    // 成功后可以选择隐藏对话框和清除输入框的值
                    document.getElementById("inputPassengerDialog").style.display = "none";
                    document.getElementById("CardCode").value = '';
                    document.getElementById("start_station").value = '';
                })
                .catch(error => {
                    alert("乘客进站失败：" + error.message);
                });
        }
    })

    document.getElementById("exitConfirmButton").addEventListener("click", function ()  {
        var ID = document.getElementById("PassengerID").value;
        var code = document.getElementById("CardCode").value;
        var startStation = document.getElementById("start_station").value;
        var endStation = document.getElementById("exit_station").value;
        var time = new Date(new Date().getTime()).toISOString();
        if (ID != '') {
            var data = {
                passengerId: ID,
                startStation: startStation,
                endStation: endStation,
                endTime: time,
            };
            //添加ride
            fetch('http://localhost:8080/passengerRide/insert', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(data)
            })
                .then(response => {
                    if (response.ok) {
                        return response.text();
                    }
                    throw new Error('行程记录失败！');
                })
                .then(message => {
                    alert("行程记录成功！" + message);
                })
                .catch(error => {
                    alert("行程记录失败：" + error.message);
                });
            //删除onboard
            fetch('http://localhost:8080/passengerOnboard/deleteByIdStation?' +
                'passenger_id=' + ID + '&start_station=' + startStation,
                {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
            })
                .then(response => {
                if (response.ok) {
                    return response.text();
                }
                throw new Error('乘客出站失败！');
            })
                .then(message => {
                    alert("乘客出站成功！" + message);
                    // 成功后可以选择隐藏对话框和清除输入框的值
                    document.getElementById("inputPassengerDialog").style.display = "none";
                    document.getElementById("PassengerID").value = '';
                    document.getElementById("start_station").value = '';
                    document.getElementById("exit_station").value = '';
                })
                .catch(error => {
                    alert("乘客出站失败：" + error.message);
                });
        } else if (code != ''){
            var data = {
                cardCode: code,
                startStation: startStation,
                endStation: endStation,
                endTime: time,
            };
            fetch('http://localhost:8080/cardRide/insert', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(data)
            })
                .then(response => {
                    if (response.ok) {
                        return response.text();
                    }
                    throw new Error('行程记录失败！');
                })
                .then(message => {
                    alert("行程记录成功！" + message);
                })
                .catch(error => {
                    alert("行程记录失败：" + error.message);
                });
            fetch('http://localhost:8080/cardOnboard/deleteByCodeStation?' + 'card_code' + code + '&start_station=' + startStation,
                {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                }).then(response => {
                if (response.ok) {
                    return response.text();
                }
                throw new Error('乘客出站失败！');
            })
                .then(message => {
                    alert("乘客出站成功！" + message);
                    // 成功后可以选择隐藏对话框和清除输入框的值
                    document.getElementById("inputPassengerDialog").style.display = "none";
                    document.getElementById("CardCode").value = '';
                    document.getElementById("start_station").value = '';
                    document.getElementById("exit_station").value = '';
                })
                .catch(error => {
                    alert("乘客出站失败：" + error.message);
                });
        }
    })
</script>
<!-- 查询上车乘客按钮 -->
<script>
    document.getElementById("viewPassengerButton").addEventListener("click", function() {
        // 构造目标跳转链接
        var targetURL = "http://localhost:8080/passengerOnboard/selectAllPassengerOnboard";
        // 执行页面跳转
        window.location.href = targetURL;
    });
</script>
<!-- 查询上车公交卡按钮-->
<script>
    document.getElementById("viewCardButton").addEventListener("click", function() {
        // 构造目标跳转链接
        var targetURL = "http://localhost:8080/cardOnboard/selectAllCardOnboard";
        // 执行页面跳转
        window.location.href = targetURL;
    });
</script>

</body>
</html>

